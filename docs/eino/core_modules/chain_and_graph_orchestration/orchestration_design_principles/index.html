<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.151.0"><meta name=ROBOTS content="INDEX, FOLLOW"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Eino: The design concept of orchestration | CloudWeGo</title><meta name=description content="A leading practice for building enterprise cloud native middleware!"><meta property="og:url" content="https://www.cloudwego.io/docs/eino/core_modules/chain_and_graph_orchestration/orchestration_design_principles/"><meta property="og:site_name" content="CloudWeGo"><meta property="og:title" content="Eino: The design concept of orchestration"><meta property="og:description" content="In the LLM application orchestration solutions, the most popular ones are langchain and langgraph, which officially provide SDKs for Python and TypeScript. These two languages are known for their flexibility, which brings great convenience to SDK development but also causes significant confusion and cognitive burden for SDK users.
As an extremely simple programming language, Go’s defined static types are one of the key reasons why it remains straightforward, and Eino maintains this critical characteristic: defined types + compile-time type checking."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="docs"><meta property="article:published_time" content="2025-03-18T00:00:00+00:00"><meta property="article:modified_time" content="2025-12-04T14:50:16+08:00"><meta itemprop=name content="Eino: The design concept of orchestration"><meta itemprop=description content="In the LLM application orchestration solutions, the most popular ones are langchain and langgraph, which officially provide SDKs for Python and TypeScript. These two languages are known for their flexibility, which brings great convenience to SDK development but also causes significant confusion and cognitive burden for SDK users.
As an extremely simple programming language, Go’s defined static types are one of the key reasons why it remains straightforward, and Eino maintains this critical characteristic: defined types + compile-time type checking."><meta itemprop=datePublished content="2025-03-18T00:00:00+00:00"><meta itemprop=dateModified content="2025-12-04T14:50:16+08:00"><meta itemprop=wordCount content="3883"><meta name=twitter:card content="summary"><meta name=twitter:title content="Eino: The design concept of orchestration"><meta name=twitter:description content="In the LLM application orchestration solutions, the most popular ones are langchain and langgraph, which officially provide SDKs for Python and TypeScript. These two languages are known for their flexibility, which brings great convenience to SDK development but also causes significant confusion and cognitive burden for SDK users.
As an extremely simple programming language, Go’s defined static types are one of the key reasons why it remains straightforward, and Eino maintains this critical characteristic: defined types + compile-time type checking."><script async src="https://www.googletagmanager.com/gtag/js?id=G-QYWRQRLPRM"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-QYWRQRLPRM")</script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?f1808c42af827f368aa7eca3baae6d55",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><link rel=preload href=/scss/main.min.d0565a84fd64e4509a7b04e7b8a1dea7a62e5003c4169dbdf36f0efab5e40e1c.css as=style><link href=/scss/main.min.d0565a84fd64e4509a7b04e7b8a1dea7a62e5003c4169dbdf36f0efab5e40e1c.css rel=stylesheet integrity><script src=/js/jquery.min.js></script><link rel=stylesheet href=/css/prism.css><link rel=stylesheet href=/css/docsearch.css></head><body class=td-page><header><nav class="js-navbar-scroll navbar navbar-expand-xl navbar-dark td-navbar"><a class=navbar-brand href=/><span class=navbar-logo><img src=/img/logo.png></span>
</a><button class=navbar-toggler type=button data-toggle=collapse data-target=#main_navbar aria-controls=main_navbar aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0 ml-auto"><li class="dropdown sub-menu active"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><span>Documentation</span></a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/docs/kitex/>Kitex</a>
<a class=dropdown-item href=/docs/hertz/>Hertz</a>
<a class=dropdown-item href=/docs/volo/>Volo</a>
<a class=dropdown-item href=/docs/netpoll/>Netpoll</a>
<a class=dropdown-item href=/docs/eino/>Eino</a></div></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/about/><span>About</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/blog/><span>Blog</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/community/><span>Community</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/cooperation/><span>Cooperation</span></a></li><li class="dropdown sub-menu"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><span>Security</span></a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/security/safety-bulletin/>safety-bulletin</a>
<a class=dropdown-item href=/security/vulnerability-reporting/>vulnerability-reporting</a></div></li><li class="nav-item dropdown mr-4"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>English</a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/zh/docs/eino/core_modules/chain_and_graph_orchestration/orchestration_design_principles/>中文</a></div></li></ul></div><div class="navbar-nav d-none d-lg-block"><div id=docsearch></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><div id=content-mobile><form class="td-sidebar__search d-flex align-items-center"><div id=docsearch></div><button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-docs-nav aria-expanded=false aria-label="Toggle section navigation"></button></form></div><div id=content-desktop></div><nav class="collapse td-sidebar-nav foldable-nav" id=td-section-nav><div class="nav-item dropdown d-block d-lg-none"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>English</a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/zh/docs/eino/core_modules/chain_and_graph_orchestration/orchestration_design_principles/>中文</a></div></div><ul class="td-sidebar-nav__section pr-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docs-li><a href=/docs/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-docs><span>Documentation</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docseino-li><input type=checkbox id=m-docseino-check checked>
<label for=m-docseino-check><a href=/docs/eino/ title="Eino: User Manual" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docseino><span>Eino</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docseinooverview-li><input type=checkbox id=m-docseinooverview-check checked>
<label for=m-docseinooverview-check><a href=/docs/eino/overview/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docseinooverview><span>Eino: Overview</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinooverviewbytedance_eino_practice-li><input type=checkbox id=m-docseinooverviewbytedance_eino_practice-check>
<label for=m-docseinooverviewbytedance_eino_practice-check><a href=/docs/eino/overview/bytedance_eino_practice/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinooverviewbytedance_eino_practice><span>Bytedance LLM Application Go Development Framework-Eino Practice</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoovervieweino_open_source-li><input type=checkbox id=m-docseinoovervieweino_open_source-check>
<label for=m-docseinoovervieweino_open_source-check><a href=/docs/eino/overview/eino_open_source/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoovervieweino_open_source><span>Large Language Model Application Development Framework — Eino is Now Open Source!</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoovervieweino_framework_structure-li><input type=checkbox id=m-docseinoovervieweino_framework_structure-check>
<label for=m-docseinoovervieweino_framework_structure-check><a href=/docs/eino/overview/eino_framework_structure/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoovervieweino_framework_structure><span>The structure of the Eino Framework</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docseinoquick_start-li><input type=checkbox id=m-docseinoquick_start-check checked>
<label for=m-docseinoquick_start-check><a href=/docs/eino/quick_start/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docseinoquick_start><span>Eino: Quick start</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoquick_startsimple_llm_application-li><input type=checkbox id=m-docseinoquick_startsimple_llm_application-check>
<label for=m-docseinoquick_startsimple_llm_application-check><a href=/docs/eino/quick_start/simple_llm_application/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoquick_startsimple_llm_application><span>Implement an easy LLM application</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoquick_startagent_llm_with_tools-li><input type=checkbox id=m-docseinoquick_startagent_llm_with_tools-check>
<label for=m-docseinoquick_startagent_llm_with_tools-check><a href=/docs/eino/quick_start/agent_llm_with_tools/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoquick_startagent_llm_with_tools><span>Agent-Enable LLM to have hands</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docseinocore_modules-li><input type=checkbox id=m-docseinocore_modules-check checked>
<label for=m-docseinocore_modules-check><a href=/docs/eino/core_modules/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docseinocore_modules><span>Eino: Core Modules</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docseinocore_modulesflow_integration_components-li><input type=checkbox id=m-docseinocore_modulesflow_integration_components-check>
<label for=m-docseinocore_modulesflow_integration_components-check><a href=/docs/eino/core_modules/flow_integration_components/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docseinocore_modulesflow_integration_components><span>Eino: Flow integration</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinocore_modulesflow_integration_componentsreact_agent_manual-li><input type=checkbox id=m-docseinocore_modulesflow_integration_componentsreact_agent_manual-check>
<label for=m-docseinocore_modulesflow_integration_componentsreact_agent_manual-check><a href=/docs/eino/core_modules/flow_integration_components/react_agent_manual/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinocore_modulesflow_integration_componentsreact_agent_manual><span>Eino: React Agent Manual</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinocore_modulesflow_integration_componentsmulti_agent_hosting-li><input type=checkbox id=m-docseinocore_modulesflow_integration_componentsmulti_agent_hosting-check>
<label for=m-docseinocore_modulesflow_integration_componentsmulti_agent_hosting-check><a href=/docs/eino/core_modules/flow_integration_components/multi_agent_hosting/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinocore_modulesflow_integration_componentsmulti_agent_hosting><span>Eino Tutorial: Host Multi-Agent</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docseinocore_moduleschain_and_graph_orchestration-li><input type=checkbox id=m-docseinocore_moduleschain_and_graph_orchestration-check checked>
<label for=m-docseinocore_moduleschain_and_graph_orchestration-check><a href=/docs/eino/core_modules/chain_and_graph_orchestration/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docseinocore_moduleschain_and_graph_orchestration><span>Eino: Chain & Graph & Workflow Orchestration</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinocore_moduleschain_and_graph_orchestrationchain_graph_introduction-li><input type=checkbox id=m-docseinocore_moduleschain_and_graph_orchestrationchain_graph_introduction-check>
<label for=m-docseinocore_moduleschain_and_graph_orchestrationchain_graph_introduction-check><a href=/docs/eino/core_modules/chain_and_graph_orchestration/chain_graph_introduction/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinocore_moduleschain_and_graph_orchestrationchain_graph_introduction><span>Eino: Chain/Graph Orchestration Introduction</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-docseinocore_moduleschain_and_graph_orchestrationorchestration_design_principles-li><input type=checkbox id=m-docseinocore_moduleschain_and_graph_orchestrationorchestration_design_principles-check checked>
<label for=m-docseinocore_moduleschain_and_graph_orchestrationorchestration_design_principles-check><a href=/docs/eino/core_modules/chain_and_graph_orchestration/orchestration_design_principles/ class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id=m-docseinocore_moduleschain_and_graph_orchestrationorchestration_design_principles><span class=td-sidebar-nav-active-item>Eino: The design concept of orchestration</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinocore_moduleschain_and_graph_orchestrationstream_programming_essentials-li><input type=checkbox id=m-docseinocore_moduleschain_and_graph_orchestrationstream_programming_essentials-check>
<label for=m-docseinocore_moduleschain_and_graph_orchestrationstream_programming_essentials-check><a href=/docs/eino/core_modules/chain_and_graph_orchestration/stream_programming_essentials/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinocore_moduleschain_and_graph_orchestrationstream_programming_essentials><span>Eino Points of Streaming Orchestration</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinocore_moduleschain_and_graph_orchestrationcallback_manual-li><input type=checkbox id=m-docseinocore_moduleschain_and_graph_orchestrationcallback_manual-check>
<label for=m-docseinocore_moduleschain_and_graph_orchestrationcallback_manual-check><a href=/docs/eino/core_modules/chain_and_graph_orchestration/callback_manual/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinocore_moduleschain_and_graph_orchestrationcallback_manual><span>Eino: Callback Manual</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinocore_moduleschain_and_graph_orchestrationcall_option_capabilities-li><input type=checkbox id=m-docseinocore_moduleschain_and_graph_orchestrationcall_option_capabilities-check>
<label for=m-docseinocore_moduleschain_and_graph_orchestrationcall_option_capabilities-check><a href=/docs/eino/core_modules/chain_and_graph_orchestration/call_option_capabilities/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinocore_moduleschain_and_graph_orchestrationcall_option_capabilities><span>Eino: CallOption capabilities and specification</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinocore_moduleschain_and_graph_orchestrationinterrupt_checkpoint-li><input type=checkbox id=m-docseinocore_moduleschain_and_graph_orchestrationinterrupt_checkpoint-check>
<label for=m-docseinocore_moduleschain_and_graph_orchestrationinterrupt_checkpoint-check><a href=/docs/eino/core_modules/chain_and_graph_orchestration/interrupt_checkpoint/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinocore_moduleschain_and_graph_orchestrationinterrupt_checkpoint><span>Eino: Interrupt & CheckPoint User Manual</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinocore_moduleschain_and_graph_orchestrationworkflow_orchestration_framework-li><input type=checkbox id=m-docseinocore_moduleschain_and_graph_orchestrationworkflow_orchestration_framework-check>
<label for=m-docseinocore_moduleschain_and_graph_orchestrationworkflow_orchestration_framework-check><a href=/docs/eino/core_modules/chain_and_graph_orchestration/workflow_orchestration_framework/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinocore_moduleschain_and_graph_orchestrationworkflow_orchestration_framework><span>Eino: Workflow Orchestration Framework</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docseinocore_modulescomponents-li><input type=checkbox id=m-docseinocore_modulescomponents-check>
<label for=m-docseinocore_modulescomponents-check><a href=/docs/eino/core_modules/components/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docseinocore_modulescomponents><span>Eino: Components</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinocore_modulescomponentschat_model_guide-li><input type=checkbox id=m-docseinocore_modulescomponentschat_model_guide-check>
<label for=m-docseinocore_modulescomponentschat_model_guide-check><a href=/docs/eino/core_modules/components/chat_model_guide/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinocore_modulescomponentschat_model_guide><span>Eino: ChatModel guide</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinocore_modulescomponentsdocument_transformer_guide-li><input type=checkbox id=m-docseinocore_modulescomponentsdocument_transformer_guide-check>
<label for=m-docseinocore_modulescomponentsdocument_transformer_guide-check><a href=/docs/eino/core_modules/components/document_transformer_guide/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinocore_modulescomponentsdocument_transformer_guide><span>Eino: Document Transformer guide</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinocore_modulescomponentschat_template_guide-li><input type=checkbox id=m-docseinocore_modulescomponentschat_template_guide-check>
<label for=m-docseinocore_modulescomponentschat_template_guide-check><a href=/docs/eino/core_modules/components/chat_template_guide/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinocore_modulescomponentschat_template_guide><span>Eino: ChatTemplate guide</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinocore_modulescomponentslambda_guide-li><input type=checkbox id=m-docseinocore_modulescomponentslambda_guide-check>
<label for=m-docseinocore_modulescomponentslambda_guide-check><a href=/docs/eino/core_modules/components/lambda_guide/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinocore_modulescomponentslambda_guide><span>Eino: Lambda guide</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinocore_modulescomponentsretriever_guide-li><input type=checkbox id=m-docseinocore_modulescomponentsretriever_guide-check>
<label for=m-docseinocore_modulescomponentsretriever_guide-check><a href=/docs/eino/core_modules/components/retriever_guide/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinocore_modulescomponentsretriever_guide><span>Eino: Retriever guide</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docseinocore_modulescomponentstools_node_guide-li><input type=checkbox id=m-docseinocore_modulescomponentstools_node_guide-check>
<label for=m-docseinocore_modulescomponentstools_node_guide-check><a href=/docs/eino/core_modules/components/tools_node_guide/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docseinocore_modulescomponentstools_node_guide><span>Eino: ToolsNode guide</span></a></label><ul class="ul-5 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinocore_modulescomponentstools_node_guidehow_to_create_a_tool-li><input type=checkbox id=m-docseinocore_modulescomponentstools_node_guidehow_to_create_a_tool-check>
<label for=m-docseinocore_modulescomponentstools_node_guidehow_to_create_a_tool-check><a href=/docs/eino/core_modules/components/tools_node_guide/how_to_create_a_tool/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinocore_modulescomponentstools_node_guidehow_to_create_a_tool><span>How to create a tool?</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docseinocore_modulescomponentsdocument_loader_guide-li><input type=checkbox id=m-docseinocore_modulescomponentsdocument_loader_guide-check>
<label for=m-docseinocore_modulescomponentsdocument_loader_guide-check><a href=/docs/eino/core_modules/components/document_loader_guide/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docseinocore_modulescomponentsdocument_loader_guide><span>Eino: Document Loader guide</span></a></label><ul class="ul-5 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinocore_modulescomponentsdocument_loader_guidedocument_parser_interface_guide-li><input type=checkbox id=m-docseinocore_modulescomponentsdocument_loader_guidedocument_parser_interface_guide-check>
<label for=m-docseinocore_modulescomponentsdocument_loader_guidedocument_parser_interface_guide-check><a href=/docs/eino/core_modules/components/document_loader_guide/document_parser_interface_guide/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinocore_modulescomponentsdocument_loader_guidedocument_parser_interface_guide><span>Eino: Document Parser guide</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinocore_modulescomponentsembedding_guide-li><input type=checkbox id=m-docseinocore_modulescomponentsembedding_guide-check>
<label for=m-docseinocore_modulescomponentsembedding_guide-check><a href=/docs/eino/core_modules/components/embedding_guide/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinocore_modulescomponentsembedding_guide><span>Eino: Embedding guide</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinocore_modulescomponentsindexer_guide-li><input type=checkbox id=m-docseinocore_modulescomponentsindexer_guide-check>
<label for=m-docseinocore_modulescomponentsindexer_guide-check><a href=/docs/eino/core_modules/components/indexer_guide/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinocore_modulescomponentsindexer_guide><span>Eino: Indexer guide</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docseinocore_modulesdevops-li><input type=checkbox id=m-docseinocore_modulesdevops-check>
<label for=m-docseinocore_modulesdevops-check><a href=/docs/eino/core_modules/devops/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docseinocore_modulesdevops><span>EinoDev: Devops tools</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinocore_modulesdevopside_plugin_guide-li><input type=checkbox id=m-docseinocore_modulesdevopside_plugin_guide-check>
<label for=m-docseinocore_modulesdevopside_plugin_guide-check><a href=/docs/eino/core_modules/devops/ide_plugin_guide/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinocore_modulesdevopside_plugin_guide><span>EinoDev IDE Plugin Introduction</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinocore_modulesdevopsvisual_orchestration_plugin_guide-li><input type=checkbox id=m-docseinocore_modulesdevopsvisual_orchestration_plugin_guide-check>
<label for=m-docseinocore_modulesdevopsvisual_orchestration_plugin_guide-check><a href=/docs/eino/core_modules/devops/visual_orchestration_plugin_guide/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinocore_modulesdevopsvisual_orchestration_plugin_guide><span>EinoDev visual orchestration plugin guide</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinocore_modulesdevopsvisual_debug_plugin_guide-li><input type=checkbox id=m-docseinocore_modulesdevopsvisual_debug_plugin_guide-check>
<label for=m-docseinocore_modulesdevopsvisual_debug_plugin_guide-check><a href=/docs/eino/core_modules/devops/visual_debug_plugin_guide/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinocore_modulesdevopsvisual_debug_plugin_guide><span>EinoDev visual debug plugin guide</span></a></label></li></ul></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docseinoecosystem_integration-li><input type=checkbox id=m-docseinoecosystem_integration-check checked>
<label for=m-docseinoecosystem_integration-check><a href=/docs/eino/ecosystem_integration/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docseinoecosystem_integration><span>Eino: Component Integration</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docseinoecosystem_integrationchat_template-li><input type=checkbox id=m-docseinoecosystem_integrationchat_template-check>
<label for=m-docseinoecosystem_integrationchat_template-check><a href=/docs/eino/ecosystem_integration/chat_template/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docseinoecosystem_integrationchat_template><span>ChatTemplate</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationchat_templatechat_template_mcp-li><input type=checkbox id=m-docseinoecosystem_integrationchat_templatechat_template_mcp-check>
<label for=m-docseinoecosystem_integrationchat_templatechat_template_mcp-check><a href=/docs/eino/ecosystem_integration/chat_template/chat_template_mcp/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationchat_templatechat_template_mcp><span>ChatTemplate - MCP</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docseinoecosystem_integrationcallbacks-li><input type=checkbox id=m-docseinoecosystem_integrationcallbacks-check>
<label for=m-docseinoecosystem_integrationcallbacks-check><a href=/docs/eino/ecosystem_integration/callbacks/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docseinoecosystem_integrationcallbacks><span>Callbacks</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationcallbackscallback_langfuse-li><input type=checkbox id=m-docseinoecosystem_integrationcallbackscallback_langfuse-check>
<label for=m-docseinoecosystem_integrationcallbackscallback_langfuse-check><a href=/docs/eino/ecosystem_integration/callbacks/callback_langfuse/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationcallbackscallback_langfuse><span>Callback - Langfuse</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationcallbackscallback_apmplus-li><input type=checkbox id=m-docseinoecosystem_integrationcallbackscallback_apmplus-check>
<label for=m-docseinoecosystem_integrationcallbackscallback_apmplus-check><a href=/docs/eino/ecosystem_integration/callbacks/callback_apmplus/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationcallbackscallback_apmplus><span>Callback - APMPlus</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationcallbackscallback_cozeloop-li><input type=checkbox id=m-docseinoecosystem_integrationcallbackscallback_cozeloop-check>
<label for=m-docseinoecosystem_integrationcallbackscallback_cozeloop-check><a href=/docs/eino/ecosystem_integration/callbacks/callback_cozeloop/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationcallbackscallback_cozeloop><span>Callback - cozeloop</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docseinoecosystem_integrationchat_model-li><input type=checkbox id=m-docseinoecosystem_integrationchat_model-check>
<label for=m-docseinoecosystem_integrationchat_model-check><a href=/docs/eino/ecosystem_integration/chat_model/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docseinoecosystem_integrationchat_model><span>ChatModel</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationchat_modelchat_model_ark-li><input type=checkbox id=m-docseinoecosystem_integrationchat_modelchat_model_ark-check>
<label for=m-docseinoecosystem_integrationchat_modelchat_model_ark-check><a href=/docs/eino/ecosystem_integration/chat_model/chat_model_ark/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationchat_modelchat_model_ark><span>ChatModel - ark</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationchat_modelchat_model_arkbot-li><input type=checkbox id=m-docseinoecosystem_integrationchat_modelchat_model_arkbot-check>
<label for=m-docseinoecosystem_integrationchat_modelchat_model_arkbot-check><a href=/docs/eino/ecosystem_integration/chat_model/chat_model_arkbot/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationchat_modelchat_model_arkbot><span>ChatModel - arkbot</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationchat_modelchat_model_claude-li><input type=checkbox id=m-docseinoecosystem_integrationchat_modelchat_model_claude-check>
<label for=m-docseinoecosystem_integrationchat_modelchat_model_claude-check><a href=/docs/eino/ecosystem_integration/chat_model/chat_model_claude/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationchat_modelchat_model_claude><span>ChatModel - claude</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationchat_modelchat_model_deepseek-li><input type=checkbox id=m-docseinoecosystem_integrationchat_modelchat_model_deepseek-check>
<label for=m-docseinoecosystem_integrationchat_modelchat_model_deepseek-check><a href=/docs/eino/ecosystem_integration/chat_model/chat_model_deepseek/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationchat_modelchat_model_deepseek><span>ChatModel - deepseek</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationchat_modelchat_model_gemini-li><input type=checkbox id=m-docseinoecosystem_integrationchat_modelchat_model_gemini-check>
<label for=m-docseinoecosystem_integrationchat_modelchat_model_gemini-check><a href=/docs/eino/ecosystem_integration/chat_model/chat_model_gemini/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationchat_modelchat_model_gemini><span>ChatModel - gemini</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationchat_modelchat_model_ollama-li><input type=checkbox id=m-docseinoecosystem_integrationchat_modelchat_model_ollama-check>
<label for=m-docseinoecosystem_integrationchat_modelchat_model_ollama-check><a href=/docs/eino/ecosystem_integration/chat_model/chat_model_ollama/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationchat_modelchat_model_ollama><span>ChatModel - ollama</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationchat_modelchat_model_openai-li><input type=checkbox id=m-docseinoecosystem_integrationchat_modelchat_model_openai-check>
<label for=m-docseinoecosystem_integrationchat_modelchat_model_openai-check><a href=/docs/eino/ecosystem_integration/chat_model/chat_model_openai/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationchat_modelchat_model_openai><span>ChatModel - openai</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationchat_modelchat_model_qianfan-li><input type=checkbox id=m-docseinoecosystem_integrationchat_modelchat_model_qianfan-check>
<label for=m-docseinoecosystem_integrationchat_modelchat_model_qianfan-check><a href=/docs/eino/ecosystem_integration/chat_model/chat_model_qianfan/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationchat_modelchat_model_qianfan><span>ChatModel - qianfan</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationchat_modelchat_model_qwen-li><input type=checkbox id=m-docseinoecosystem_integrationchat_modelchat_model_qwen-check>
<label for=m-docseinoecosystem_integrationchat_modelchat_model_qwen-check><a href=/docs/eino/ecosystem_integration/chat_model/chat_model_qwen/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationchat_modelchat_model_qwen><span>ChatModel - qwen</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docseinoecosystem_integrationdocument-li><input type=checkbox id=m-docseinoecosystem_integrationdocument-check>
<label for=m-docseinoecosystem_integrationdocument-check><a href=/docs/eino/ecosystem_integration/document/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docseinoecosystem_integrationdocument><span>Document</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationdocumentsplitter_markdown-li><input type=checkbox id=m-docseinoecosystem_integrationdocumentsplitter_markdown-check>
<label for=m-docseinoecosystem_integrationdocumentsplitter_markdown-check><a href=/docs/eino/ecosystem_integration/document/splitter_markdown/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationdocumentsplitter_markdown><span>Splitter - markdown</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationdocumentloader_amazon_s3-li><input type=checkbox id=m-docseinoecosystem_integrationdocumentloader_amazon_s3-check>
<label for=m-docseinoecosystem_integrationdocumentloader_amazon_s3-check><a href=/docs/eino/ecosystem_integration/document/loader_amazon_s3/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationdocumentloader_amazon_s3><span>Loader - amazon s3</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationdocumentloader_local_file-li><input type=checkbox id=m-docseinoecosystem_integrationdocumentloader_local_file-check>
<label for=m-docseinoecosystem_integrationdocumentloader_local_file-check><a href=/docs/eino/ecosystem_integration/document/loader_local_file/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationdocumentloader_local_file><span>Loader - local file</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationdocumentloader_web_url-li><input type=checkbox id=m-docseinoecosystem_integrationdocumentloader_web_url-check>
<label for=m-docseinoecosystem_integrationdocumentloader_web_url-check><a href=/docs/eino/ecosystem_integration/document/loader_web_url/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationdocumentloader_web_url><span>Loader - web url</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationdocumentparser_html-li><input type=checkbox id=m-docseinoecosystem_integrationdocumentparser_html-check>
<label for=m-docseinoecosystem_integrationdocumentparser_html-check><a href=/docs/eino/ecosystem_integration/document/parser_html/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationdocumentparser_html><span>Parser - html</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationdocumentparser_pdf-li><input type=checkbox id=m-docseinoecosystem_integrationdocumentparser_pdf-check>
<label for=m-docseinoecosystem_integrationdocumentparser_pdf-check><a href=/docs/eino/ecosystem_integration/document/parser_pdf/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationdocumentparser_pdf><span>Parser - pdf</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationdocumentsplitter_recursive-li><input type=checkbox id=m-docseinoecosystem_integrationdocumentsplitter_recursive-check>
<label for=m-docseinoecosystem_integrationdocumentsplitter_recursive-check><a href=/docs/eino/ecosystem_integration/document/splitter_recursive/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationdocumentsplitter_recursive><span>Splitter - recursive</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationdocumentsplitter_semantic-li><input type=checkbox id=m-docseinoecosystem_integrationdocumentsplitter_semantic-check>
<label for=m-docseinoecosystem_integrationdocumentsplitter_semantic-check><a href=/docs/eino/ecosystem_integration/document/splitter_semantic/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationdocumentsplitter_semantic><span>Splitter - semantic</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docseinoecosystem_integrationembedding-li><input type=checkbox id=m-docseinoecosystem_integrationembedding-check>
<label for=m-docseinoecosystem_integrationembedding-check><a href=/docs/eino/ecosystem_integration/embedding/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docseinoecosystem_integrationembedding><span>Embedding</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationembeddingembedding_ollama-li><input type=checkbox id=m-docseinoecosystem_integrationembeddingembedding_ollama-check>
<label for=m-docseinoecosystem_integrationembeddingembedding_ollama-check><a href=/docs/eino/ecosystem_integration/embedding/embedding_ollama/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationembeddingembedding_ollama><span>Embedding - Ollama</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationembeddingembedding_openai-li><input type=checkbox id=m-docseinoecosystem_integrationembeddingembedding_openai-check>
<label for=m-docseinoecosystem_integrationembeddingembedding_openai-check><a href=/docs/eino/ecosystem_integration/embedding/embedding_openai/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationembeddingembedding_openai><span>Embedding - OpenAI</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationembeddingembedding_ark-li><input type=checkbox id=m-docseinoecosystem_integrationembeddingembedding_ark-check>
<label for=m-docseinoecosystem_integrationembeddingembedding_ark-check><a href=/docs/eino/ecosystem_integration/embedding/embedding_ark/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationembeddingembedding_ark><span>Embedding - ARK</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationembeddingembedding_dashscope-li><input type=checkbox id=m-docseinoecosystem_integrationembeddingembedding_dashscope-check>
<label for=m-docseinoecosystem_integrationembeddingembedding_dashscope-check><a href=/docs/eino/ecosystem_integration/embedding/embedding_dashscope/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationembeddingembedding_dashscope><span>Embedding - dashscope</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationembeddingembedding_qianfan-li><input type=checkbox id=m-docseinoecosystem_integrationembeddingembedding_qianfan-check>
<label for=m-docseinoecosystem_integrationembeddingembedding_qianfan-check><a href=/docs/eino/ecosystem_integration/embedding/embedding_qianfan/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationembeddingembedding_qianfan><span>Embedding - qianfan</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationembeddingembedding_tencentcloud-li><input type=checkbox id=m-docseinoecosystem_integrationembeddingembedding_tencentcloud-check>
<label for=m-docseinoecosystem_integrationembeddingembedding_tencentcloud-check><a href=/docs/eino/ecosystem_integration/embedding/embedding_tencentcloud/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationembeddingembedding_tencentcloud><span>Embedding - tencentcloud</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docseinoecosystem_integrationindexer-li><input type=checkbox id=m-docseinoecosystem_integrationindexer-check>
<label for=m-docseinoecosystem_integrationindexer-check><a href=/docs/eino/ecosystem_integration/indexer/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docseinoecosystem_integrationindexer><span>Indexer</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationindexerindexer_es8-li><input type=checkbox id=m-docseinoecosystem_integrationindexerindexer_es8-check>
<label for=m-docseinoecosystem_integrationindexerindexer_es8-check><a href=/docs/eino/ecosystem_integration/indexer/indexer_es8/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationindexerindexer_es8><span>Indexer - es8</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationindexerindexer_milvus-li><input type=checkbox id=m-docseinoecosystem_integrationindexerindexer_milvus-check>
<label for=m-docseinoecosystem_integrationindexerindexer_milvus-check><a href=/docs/eino/ecosystem_integration/indexer/indexer_milvus/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationindexerindexer_milvus><span>Indexer - milvus</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationindexerindexer_redis-li><input type=checkbox id=m-docseinoecosystem_integrationindexerindexer_redis-check>
<label for=m-docseinoecosystem_integrationindexerindexer_redis-check><a href=/docs/eino/ecosystem_integration/indexer/indexer_redis/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationindexerindexer_redis><span>Indexer - redis</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationindexerindexer_volc_vikingdb-li><input type=checkbox id=m-docseinoecosystem_integrationindexerindexer_volc_vikingdb-check>
<label for=m-docseinoecosystem_integrationindexerindexer_volc_vikingdb-check><a href=/docs/eino/ecosystem_integration/indexer/indexer_volc_vikingdb/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationindexerindexer_volc_vikingdb><span>Indexer - volc VikingDB</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docseinoecosystem_integrationretriever-li><input type=checkbox id=m-docseinoecosystem_integrationretriever-check>
<label for=m-docseinoecosystem_integrationretriever-check><a href=/docs/eino/ecosystem_integration/retriever/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docseinoecosystem_integrationretriever><span>Retriever</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationretrieverretriever_es8-li><input type=checkbox id=m-docseinoecosystem_integrationretrieverretriever_es8-check>
<label for=m-docseinoecosystem_integrationretrieverretriever_es8-check><a href=/docs/eino/ecosystem_integration/retriever/retriever_es8/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationretrieverretriever_es8><span>Retriever - es8</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationretrieverretriever_redis-li><input type=checkbox id=m-docseinoecosystem_integrationretrieverretriever_redis-check>
<label for=m-docseinoecosystem_integrationretrieverretriever_redis-check><a href=/docs/eino/ecosystem_integration/retriever/retriever_redis/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationretrieverretriever_redis><span>Retriever - redis</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationretrieverretriever_volc_knowledge-li><input type=checkbox id=m-docseinoecosystem_integrationretrieverretriever_volc_knowledge-check>
<label for=m-docseinoecosystem_integrationretrieverretriever_volc_knowledge-check><a href=/docs/eino/ecosystem_integration/retriever/retriever_volc_knowledge/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationretrieverretriever_volc_knowledge><span>Retriever - volc knowledge</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationretrieverretriever_volc_vikingdb-li><input type=checkbox id=m-docseinoecosystem_integrationretrieverretriever_volc_vikingdb-check>
<label for=m-docseinoecosystem_integrationretrieverretriever_volc_vikingdb-check><a href=/docs/eino/ecosystem_integration/retriever/retriever_volc_vikingdb/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationretrieverretriever_volc_vikingdb><span>Retriever - volc VikingDB</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationretrieverretriever_dify-li><input type=checkbox id=m-docseinoecosystem_integrationretrieverretriever_dify-check>
<label for=m-docseinoecosystem_integrationretrieverretriever_dify-check><a href=/docs/eino/ecosystem_integration/retriever/retriever_dify/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationretrieverretriever_dify><span>Retriever - dify</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationretrieverretriever_milvus-li><input type=checkbox id=m-docseinoecosystem_integrationretrieverretriever_milvus-check>
<label for=m-docseinoecosystem_integrationretrieverretriever_milvus-check><a href=/docs/eino/ecosystem_integration/retriever/retriever_milvus/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationretrieverretriever_milvus><span>Retriever - milvus</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docseinoecosystem_integrationtool-li><input type=checkbox id=m-docseinoecosystem_integrationtool-check>
<label for=m-docseinoecosystem_integrationtool-check><a href=/docs/eino/ecosystem_integration/tool/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docseinoecosystem_integrationtool><span>Tool</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationtooltool_duckduckgo_search-li><input type=checkbox id=m-docseinoecosystem_integrationtooltool_duckduckgo_search-check>
<label for=m-docseinoecosystem_integrationtooltool_duckduckgo_search-check><a href=/docs/eino/ecosystem_integration/tool/tool_duckduckgo_search/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationtooltool_duckduckgo_search><span>Tool - DuckDuckGoSearch</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationtooltool_bingsearch-li><input type=checkbox id=m-docseinoecosystem_integrationtooltool_bingsearch-check>
<label for=m-docseinoecosystem_integrationtooltool_bingsearch-check><a href=/docs/eino/ecosystem_integration/tool/tool_bingsearch/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationtooltool_bingsearch><span>Tool - Bingsearch</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationtooltool_browseruse-li><input type=checkbox id=m-docseinoecosystem_integrationtooltool_browseruse-check>
<label for=m-docseinoecosystem_integrationtooltool_browseruse-check><a href=/docs/eino/ecosystem_integration/tool/tool_browseruse/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationtooltool_browseruse><span>Tool - Browseruse</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationtooltool_commandline-li><input type=checkbox id=m-docseinoecosystem_integrationtooltool_commandline-check>
<label for=m-docseinoecosystem_integrationtooltool_commandline-check><a href=/docs/eino/ecosystem_integration/tool/tool_commandline/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationtooltool_commandline><span>Tool - Commandline</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationtooltool_googlesearch-li><input type=checkbox id=m-docseinoecosystem_integrationtooltool_googlesearch-check>
<label for=m-docseinoecosystem_integrationtooltool_googlesearch-check><a href=/docs/eino/ecosystem_integration/tool/tool_googlesearch/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationtooltool_googlesearch><span>Tool - Googlesearch</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationtooltool_httprequest-li><input type=checkbox id=m-docseinoecosystem_integrationtooltool_httprequest-check>
<label for=m-docseinoecosystem_integrationtooltool_httprequest-check><a href=/docs/eino/ecosystem_integration/tool/tool_httprequest/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationtooltool_httprequest><span>Tool - httprequest</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationtooltool_sequentialthinking-li><input type=checkbox id=m-docseinoecosystem_integrationtooltool_sequentialthinking-check>
<label for=m-docseinoecosystem_integrationtooltool_sequentialthinking-check><a href=/docs/eino/ecosystem_integration/tool/tool_sequentialthinking/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationtooltool_sequentialthinking><span>Tool - sequentialthinking</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationtooltool_wikipedia-li><input type=checkbox id=m-docseinoecosystem_integrationtooltool_wikipedia-check>
<label for=m-docseinoecosystem_integrationtooltool_wikipedia-check><a href=/docs/eino/ecosystem_integration/tool/tool_wikipedia/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationtooltool_wikipedia><span>Tool - wikipedia</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docseinoecosystem_integrationtooltool_mcp-li><input type=checkbox id=m-docseinoecosystem_integrationtooltool_mcp-check>
<label for=m-docseinoecosystem_integrationtooltool_mcp-check><a href=/docs/eino/ecosystem_integration/tool/tool_mcp/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docseinoecosystem_integrationtooltool_mcp><span>Tool - MCP</span></a></label></li></ul></li></ul></li></ul></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"><a href=https://github.com/cloudwego/cloudwego.github.io/edit/main/content/en/docs/eino/core_modules/chain_and_graph_orchestration/orchestration_design_principles.md class="td-page-meta--edit td-page-meta__edit" target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> Edit this page</a>
<a href="https://github.com/cloudwego/cloudwego.github.io/new/main/content/en/docs/eino/core_modules/chain_and_graph_orchestration?filename=change-me.md&amp;value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" class="td-page-meta--child td-page-meta__child" target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> Create child page</a>
<a href="https://github.com/cloudwego/cloudwego.github.io/issues/new?title=Eino:%20The%20design%20concept%20of%20orchestration" class="td-page-meta--issue td-page-meta__issue" target=_blank rel=noopener><i class="fa-brands fa-github fa-fw"></i> Create documentation issue</a>
<a href=https://github.com/cloudwego/eino/issues/new/choose class="td-page-meta--project td-page-meta__project-issue" target=_blank rel=noopener><i class="fa-solid fa-list-check fa-fw"></i> Create project issue</a></div><div class=td-toc><nav id=TableOfContents><ul><li><a href=#basic-principle-of-type-alignment-in-upstream-and-downstream>Basic Principle of <code>Type Alignment</code> in Upstream and Downstream</a><ul><li><a href=#type-alignment-in-graph><strong>Type Alignment in Graph</strong></a></li><li><a href=#type-alignment-in-chains>Type Alignment in Chains</a></li><li><a href=#type-alignment-in-workflow>Type Alignment in Workflow</a></li><li><a href=#type-alignment-of-statehandler>Type Alignment of StateHandler</a></li><li><a href=#alignment-of-types-under-invoke-and-stream><strong>Alignment of Types under invoke and stream</strong></a></li><li><a href=#runtime-type-alignment-check-scenarios><strong>Runtime Type Alignment Check Scenarios</strong></a></li></ul></li><li><a href=#opinionated-design-choices>Opinionated <strong>Design Choices</strong></a><ul><li><a href=#principle-of-read-only-external-variables>Principle of Read-Only External Variables</a></li><li><a href=#fan-in-and-merging><strong>Fan-In and Merging</strong></a></li><li><a href=#streaming-processing><strong>Streaming Processing</strong></a></li><li><a href=#global-state><strong>Global State</strong></a></li><li><a href=#callback-injection><strong>Callback Injection</strong></a></li><li><a href=#option-allocation><strong>Option Allocation</strong></a></li><li><a href=#graph-nesting><strong>Graph Nesting</strong></a></li></ul></li><li><a href=#internal-mechanism><strong>Internal Mechanism</strong></a><ul><li><a href=#execution-sequence><strong>Execution Sequence</strong></a></li><li><a href=#runtime-engine><strong>Runtime Engine</strong></a></li></ul></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><nav aria-label=breadcrumb class="d-none d-md-block d-print-none"><ol class="breadcrumb spb-1"><li class=breadcrumb-item><a href=https://www.cloudwego.io/docs/>Documentation</a></li><li class=breadcrumb-item><a href=https://www.cloudwego.io/docs/eino/>Eino</a></li><li class=breadcrumb-item><a href=https://www.cloudwego.io/docs/eino/core_modules/>Eino: Core Modules</a></li><li class=breadcrumb-item><a href=https://www.cloudwego.io/docs/eino/core_modules/chain_and_graph_orchestration/>Eino: Chain & Graph & Workflow Orchestration</a></li><li class="breadcrumb-item active" aria-current=page><a href=https://www.cloudwego.io/docs/eino/core_modules/chain_and_graph_orchestration/orchestration_design_principles/>Eino: The design concept of orchestration</a></li></ol></nav><div class=td-content><h1>Eino: The design concept of orchestration</h1><header class=article-meta></header><p>In the LLM application orchestration solutions, the most popular ones are langchain and langgraph, which officially provide SDKs for Python and TypeScript. These two languages are known for their flexibility, which brings great convenience to SDK development but also causes significant confusion and cognitive burden for SDK users.</p><p>As an extremely simple programming language, Go&rsquo;s defined <code>static types</code> are one of the key reasons why it remains straightforward, and Eino maintains this critical characteristic: <code>defined types</code> + <code>compile-time type checking</code>.</p><h2 id=basic-principle-of-type-alignment-in-upstream-and-downstream>Basic Principle of <code>Type Alignment</code> in Upstream and Downstream</h2><p>The most fundamental orchestration method in eino is the graph, along with the simplified wrapped chain. Regardless of the orchestration method, it essentially consists of <code>logical nodes</code> + <code>upstream and downstream relationships</code>. At runtime, the product of the orchestration starts from one logical node and then proceeds to run the next node that is connected to the current node.</p><p>This entails a basic assumption: <strong>the output value of the previous node can serve as the input value for the next node.</strong></p><p>In Go, there are two basic approaches to achieving this assumption:</p><ol><li>Convert the input and output of different nodes into a more generalized type, such as <code>any</code> or <code>map[string]any</code>.<ol><li>Adopting the approach to generalize into any, but the corresponding cost is that developers need to explicitly convert it into a specific type when writing code to use it. This significantly increases the mental burden on developers, hence this approach was ultimately abandoned.</li><li>The langchain approach can be seen as passing <code>map[string]any</code> throughout the process, where each logical node retrieves the corresponding value with the corresponding key based on its needs. In langchaingo&rsquo;s implementation, this approach is adopted. However, in Go, they still need to be used with <code>type assertions</code>. This approach still imposes a significant mental burden on the developer.</li></ol></li><li>Keep the input and output types of each node as expected by the developer, ensuring type consistency between upstream and downstream during the Compile phase.</li></ol><p>Approach 2 is the final approach selected by eino. This approach is the easiest to understand during orchestration. The whole process is like <code>building blocks</code>, where the protruding and recessed parts of each block have their own specifications, and only matching specifications can form upstream and downstream relationships.</p><p>As shown in the diagram below:</p><p><a href=/img/eino/en_eino_parallel_type.png target=_blank><img src=/img/eino/en_eino_parallel_type.png width=100%></a></p><p>For orchestration, it can only run properly if the downstream can recognize and process the upstream output. This basic assumption is clearly expressed in eino, allowing developers to be confident and clear about how orchestration logic operates and flows when using eino, rather than guessing whether the passed values are correct from a series of any.</p><h3 id=type-alignment-in-graph><strong>Type Alignment in Graph</strong></h3><h4 id=edge><strong>Edge</strong></h4><p>In a graph, the output of a node will flow to the next node along an <code>edge</code>, so the nodes connected by an edge must have type alignment.</p><p>As shown in the figure below:</p><blockquote><p>This is a scenario simulating ① Direct conversation with a LLM ② Using RAG mode, and the final results can be used to compare the effects of the two modes</p></blockquote><p><a href=/img/eino/en_eino_graph_node_type.png target=_blank><img src=/img/eino/en_eino_graph_node_type.png width=100%></a></p><p>The green part in the figure represents the ordinary edge connection, which requires that the upstream output must be able to be <code>assigned</code> downstream, and the types that can be accepted are:</p><p>① The same type for both upstream and downstream: For example, the upstream output is *schema.Message, and the downstream input is also *schema.Message.</p><p>② The downstream accepts an interface, and the upstream implements that interface: For example, the upstream structure implements the Format() interface, and the downstream accepts an interface{ Format() }. A special situation is when the downstream is any (empty interface), the upstream definitely implements any, so they can certainly connect.</p><p>③ The upstream is an interface, and the downstream is a specific type: When the downstream specific type implements the upstream&rsquo;s interface type, it may or may not work, which cannot be determined at compile time, only at runtime when the explicit type of upstream is determined. For detailed description, see: <a href=/docs/eino/core_modules/chain_and_graph_orchestration/orchestration_design_principles/>Eino: The design concept of orchestration</a></p><p>The yellow part in the figure represents another type conversion mechanism provided by eino, that is: if downstream receives a type <code>map[string]any</code>, but the upstream output type is not map[string]any, you can use <code>graph.AddXXXNode(node_key, xxx, compose.WithOutputKey("outkey")</code> to convert the upstream output type to map[string]any, where the key of the map is the OutputKey specified in the option. This mechanism is generally convenient to use when multiple edges converge to a single node.</p><h4 id=branch><strong>Branch</strong></h4><p>If a node is connected to multiple edges, the downstream nodes of each edge will run once. Branch is another mechanism: a branch followed by n nodes will only run the node corresponding to the key returned by the condition. The nodes following the same branch must also be type aligned.</p><p>As shown in the figure below:</p><blockquote><p>This is a scenario simulating the running logic of a react agent</p></blockquote><p><a href=/img/eino/en_eino_react_agent_graph.png target=_blank><img src=/img/eino/en_eino_react_agent_graph.png width=100%></a></p><p>You can see that a branch itself has a <code>condition</code>, the input of this function must be type aligned with the upstream. At the same time, the nodes following the branch must also be able to receive the upstream&rsquo;s output just like the condition.</p><h3 id=type-alignment-in-chains>Type Alignment in Chains</h3><h4 id=chain><strong>Chain</strong></h4><p>From an abstract perspective, a chain is a <code>sequence</code>, as shown below:</p><p><a href=/img/eino/en_chain_abstract_perspective.png target=_blank><img src=/img/eino/en_chain_abstract_perspective.png width=100%></a></p><p>The types of logical nodes can be divided into three categories:</p><ul><li>Orchestrable components (e.g., chat model, chat template, retriever, lambda, graph, etc.)</li><li>Branch nodes</li><li>Parallel nodes</li></ul><p>As can be seen, from the perspective of a chain, whether it is a simple node (e.g., chat model) or a complex node (e.g., graph, branch, parallel), they are treated the same. During execution, each step corresponds to the execution of a node.</p><p>Therefore, the types of upstream and downstream nodes in a chain must be aligned, as shown below:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>TestChain</span><span style=color:#000;font-weight:700>()</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>chain</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>:=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>compose</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewChain</span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>]</span><span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>]()</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>nodeTemplate</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>:=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>fakeChatTemplate</span><span style=color:#000;font-weight:700>{}</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic>// input: map[string]any, output: []*schema.Message</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>nodeHistoryLambda</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>:=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>fakeLambda</span><span style=color:#000;font-weight:700>{}</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic>// input: []*schema.Message, output: []*schema.Message</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>nodeChatModel</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>:=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>fakeChatModel</span><span style=color:#000;font-weight:700>{}</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic>// input: []*schema.Message, output: *schema.Message</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>nodeConvertResLambda</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>:=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>fakeLambda</span><span style=color:#000;font-weight:700>{}</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic>// input: *schema.Message, output: string</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>chain</span><span style=color:#000;font-weight:700>.</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#000>AppendChatTemplate</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>nodeTemplate</span><span style=color:#000;font-weight:700>).</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#000>AppendLambda</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>nodeHistoryLambda</span><span style=color:#000;font-weight:700>).</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#000>AppendChatModel</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>nodeChatModel</span><span style=color:#000;font-weight:700>).</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#000>AppendLambda</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>nodeConvertResLambda</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>The logic above can be represented by the following diagram:</p><p><a href=/img/eino/nodes_type_validate.png target=_blank><img src=/img/eino/nodes_type_validate.png width=100%></a></p><p>If the types of upstream and downstream nodes are not aligned, the chain will return an error during chain.Compile(). In contrast, the graph will report an error when calling graph.AddXXXNode().</p><h4 id=parallel>parallel</h4><p>Parallel is a special type of node within a chain. From the perspective of the chain, a parallel node is no different from other nodes. Internally, the basic topology of a parallel node is as follows:</p><p><a href=/img/eino/en_eino_type_in_parallel.png target=_blank><img src=/img/eino/en_eino_type_in_parallel.png width=100%></a></p><p>One structure formed by multiple edges in the graph is illustrated here. The basic assumption is that there is exactly one node on each edge of a parallel node. Of course, that one node can also be a graph. However, note that the current framework does not directly provide the capability to nest branch or parallel within a parallel node.</p><p>Each node within a parallel node has the same upstream node, and thus they must align with the output type of the upstream node. For example, if the upstream node outputs <code>*schema.Message</code> as shown in the diagram, then each node must be able to receive this type. The receiving method is consistent with that in the graph, typically using <code>same type</code>, <code>interface definition</code>, <code>any</code>, or <code>input key option</code>.</p><p>The output of a parallel node is always a <code>map[string]any</code>, where the key is specified as output_key when calling <code>parallel.AddXXX(output_key, xxx, opts...)</code>, and the value is the actual output of the node.</p><p>An example of constructing a parallel node is as follows:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>TestParallel</span><span style=color:#000;font-weight:700>()</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>chain</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>:=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>compose</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewChain</span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>]</span><span style=color:#204a87;font-weight:700>any</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>]</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Message</span><span style=color:#000;font-weight:700>]()</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>parallel</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>:=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>compose</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewParallel</span><span style=color:#000;font-weight:700>()</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>model01</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>:=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>fakeChatModel</span><span style=color:#000;font-weight:700>{}</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic>// input: []*schema.Message, output: *schema.Message</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>model02</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>:=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>fakeChatModel</span><span style=color:#000;font-weight:700>{}</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic>// input: []*schema.Message, output: *schema.Message</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>model03</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>:=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>fakeChatModel</span><span style=color:#000;font-weight:700>{}</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic>// input: []*schema.Message, output: *schema.Message</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>parallel</span><span style=color:#000;font-weight:700>.</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#000>AddChatModel</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;outkey_01&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>model01</span><span style=color:#000;font-weight:700>).</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#000>AddChatModel</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;outkey_02&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>model02</span><span style=color:#000;font-weight:700>).</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#000>AddChatModel</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;outkey_03&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>model03</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>lambdaNode</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>:=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>fakeLambdaNode</span><span style=color:#000;font-weight:700>{}</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic>// input: map[string]any, output: map[string]*schema.Message</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>chain</span><span style=color:#000;font-weight:700>.</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#000>AppendParallel</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>parallel</span><span style=color:#000;font-weight:700>).</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#000>AppendLambda</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>lambdaNode</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>A parallel node from the perspective of a chain looks like this:</p><blockquote><p>The diagram simulates the same question being answered by different LLMs. The results can be used for comparison.</p></blockquote><p><a href=/img/eino/en_chain_inner_nodes.png target=_blank><img src=/img/eino/en_chain_inner_nodes.png width=100%></a></p><blockquote><p>It is important to note that this structure is only a logical perspective. Since the chain itself is also implemented using a graph, the parallel node will be spread out in the underlying graph.</p></blockquote><h4 id=branch-1>branch</h4><p>The branch in a chain is similar to the branch in a graph; all nodes in the branch must be aligned with the type of upstream nodes. This will not be elaborated further here. The special nature of a chain branch is that all possible branch nodes in the branch will either connect to the same node in the chain or all connect to END.</p><h3 id=type-alignment-in-workflow>Type Alignment in Workflow</h3><p>The dimensions of type alignment in Workflow have been changed from the overall Input & Output to the field level. Specifically, it can be divided into:</p><ul><li>The overall output of the upstream is type-aligned to a specific field downstream.</li><li>A specific field of upstream output is type-aligned to the overall downstream.</li><li>A specific field of upstream output is type-aligned to a specific field of downstream input.</li></ul><p>The principles and rules are the same as for overall type alignment.</p><h3 id=type-alignment-of-statehandler>Type Alignment of StateHandler</h3><p>StatePreHandler: The input type needs to be aligned with the non-streaming input type of the corresponding node.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// The input type is []*schema.Message, which is aligned with the non-streaming input type of ChatModel</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>preHandler</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>:=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>input</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>[]</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Message</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>state</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>state</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>([]</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Message</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>error</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#8f5902;font-style:italic>// your handler logic</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>AddChatModelNode</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;xxx&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>model</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>WithStatePreHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>preHandler</span><span style=color:#000;font-weight:700>))</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>StatePostHandler: The input type needs to be aligned with the non-streaming output type of the corresponding node.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// The input type is *schema.Message, which is aligned with the non-streaming output type of ChatModel</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>postHandler</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>:=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>input</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Message</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>state</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>state</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Message</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>error</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#8f5902;font-style:italic>// your handler logic</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>AddChatModelNode</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;xxx&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>model</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>WithStatePostHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>postHandler</span><span style=color:#000;font-weight:700>))</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>StreamStatePreHandler: The input type needs to be aligned with the streaming input type of the corresponding node.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// The input type is *schema.StreamReader[[]*schema.Message], which is aligned with the streaming input type of ChatModel</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>preHandler</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>:=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>input</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>StreamReader</span><span style=color:#000;font-weight:700>[[]</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Message</span><span style=color:#000;font-weight:700>],</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>state</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>state</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>StreamReader</span><span style=color:#000;font-weight:700>[[]</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Message</span><span style=color:#000;font-weight:700>],</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>error</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#8f5902;font-style:italic>// your handler logic</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>AddChatModelNode</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;xxx&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>model</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>WithStreamStatePreHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>preHandler</span><span style=color:#000;font-weight:700>))</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>StreamStatePostHandler: The input type needs to be aligned with the streaming output type of the corresponding node.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// The input type is *schema.StreamReader[*schema.Message], which is aligned with the streaming output type of ChatModel</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>postHandler</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>:=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>input</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>StreamReader</span><span style=color:#000;font-weight:700>[</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Message</span><span style=color:#000;font-weight:700>],</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>state</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>state</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>StreamReader</span><span style=color:#000;font-weight:700>[</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Message</span><span style=color:#000;font-weight:700>],</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>error</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#8f5902;font-style:italic>// your handler logic</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>AddChatModelNode</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;xxx&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>model</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>WithStreamStatePostHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>postHandler</span><span style=color:#000;font-weight:700>))</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h3 id=alignment-of-types-under-invoke-and-stream><strong>Alignment of Types under invoke and stream</strong></h3><p>In Eino, the result of orchestration is either a graph or a chain. To execute it, you need to use <code>Compile()</code> to generate a <code>Runnable</code> interface.</p><p>One important function of Runnable is to provide four calling methods: &ldquo;Invoke&rdquo;, &ldquo;Stream&rdquo;, &ldquo;Collect&rdquo;, and &ldquo;Transform&rdquo;.</p><blockquote><p>You can check the introduction of the above calling methods and detailed runnable introduction in: <a href=/docs/eino/overview/>Eino: Overview</a></p></blockquote><p>Suppose we have a <code>Graph[[]*schema.Message, []*schema.Message]</code>, which contains a ChatModel node and a Lambda node. After compiling, it becomes a <code>Runnable[[]*schema.Message, []*schema.Message]</code>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>main</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>import</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>(</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#4e9a06>&#34;context&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#4e9a06>&#34;io&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#4e9a06>&#34;testing&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#4e9a06>&#34;github.com/cloudwego/eino/compose&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#4e9a06>&#34;github.com/cloudwego/eino/schema&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#4e9a06>&#34;github.com/stretchr/testify/assert&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>func</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>TestTypeMatch</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>t</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>testing</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>T</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>ctx</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>:=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Background</span><span style=color:#000;font-weight:700>()</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>g1</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>:=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>compose</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewGraph</span><span style=color:#000;font-weight:700>[[]</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Message</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>]()</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>_</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>g1</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>AddChatModelNode</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;model&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>mockChatModel</span><span style=color:#000;font-weight:700>{})</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>_</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>g1</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>AddLambdaNode</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;lambda&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>compose</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>InvokableLambda</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>_</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>msg</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Message</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>error</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>       </span><span style=color:#204a87;font-weight:700>return</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>msg</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Content</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>nil</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000;font-weight:700>}))</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>_</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>g1</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>AddEdge</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>compose</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>START</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;model&#34;</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>_</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>g1</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>AddEdge</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;model&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;lambda&#34;</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>_</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>g1</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>AddEdge</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;lambda&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>compose</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>END</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>runner</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>err</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>:=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>g1</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Compile</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>assert</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NoError</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>t</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>c</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>err</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>:=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>runner</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Invoke</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>[]</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Message</span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>       </span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>UserMessage</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;what&#39;s the weather in beijing?&#34;</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000;font-weight:700>})</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>assert</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NoError</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>t</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>assert</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Equal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>t</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;the weather is good&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>c</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>s</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>err</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>:=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>runner</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Stream</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>[]</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Message</span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>       </span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>UserMessage</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;what&#39;s the weather in beijing?&#34;</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000;font-weight:700>})</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>assert</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NoError</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>t</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>var</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>fullStr</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>string</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>for</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>       </span><span style=color:#000>chunk</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>err</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>:=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>s</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Recv</span><span style=color:#000;font-weight:700>()</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>       </span><span style=color:#204a87;font-weight:700>if</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>err</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>!=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>nil</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>if</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>err</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>==</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>io</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>EOF</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>             </span><span style=color:#204a87;font-weight:700>break</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>       </span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>       </span><span style=color:#000>fullStr</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>+=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>chunk</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>assert</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Equal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>t</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>c</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>fullStr</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>When we call the compiled Runnable in Stream mode, the model node outputs <code>*schema.StreamReader[*Message]</code>, but the lambda node is an InvokableLambda that only accepts non-streaming <code>*schema.Message</code> as input. This complies with the type alignment rule because the Eino framework automatically concatenates streaming Messages into a complete Message.</p><p>In stream mode, concatenating frames is a very common operation. During concatenation, all elements from <code>*StreamReader[T]</code> are first extracted and converted into <code>[]T</code>, and then an attempt is made to concatenate <code>[]T</code> into a complete <code>T</code>. The framework has built-in support for concatenating the following types:</p><ul><li><code>*schema.Message</code>: See <code>schema.ConcatMessages()</code> for details</li><li><code>string</code>: The implementation logic is equivalent to <code>+=</code></li><li><code>[]*schema.Message</code>: See <code>compose.concatMessageArray()</code> for details</li><li><code>Map</code>: Merge values with the same key; the merging logic is the same as above. If there is an un-combinable type, it fails (ps: it is not overwritten)</li><li><code>Struct</code> or <code>Struct pointer</code>: First converted into <code>[]map[string]any</code>, then merged according to the map logic. The struct must not contain unexported fields.</li><li>Other slices: Can only be merged if there is exactly one non-zero value element in the slice.</li></ul><p>For other scenarios, or when users want to override the default behavior with custom logic, developers can implement their own concat method and register it to the global concatenation function using <code>compose.RegisterStreamChunkConcatFunc()</code>.</p><p>Here is an example:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Suppose our own structure is as follows</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>type</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>tStreamConcatItemForTest</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>struct</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>s</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>string</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#8f5902;font-style:italic>// Implement a splicing method</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>func</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>concatTStreamForTest</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>items</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>[]</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>tStreamConcatItemForTest</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>tStreamConcatItemForTest</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>error</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>var</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>s</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>string</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>for</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>_</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>item</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>:=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>range</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>items</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#000>s</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>+=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>item</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>s</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>return</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>tStreamConcatItemForTest</span><span style=color:#000;font-weight:700>{</span><span style=color:#000>s</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>s</span><span style=color:#000;font-weight:700>},</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>nil</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>func</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Init</span><span style=color:#000;font-weight:700>()</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#8f5902;font-style:italic>// Register in the global splicing method</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>compose</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>RegisterStreamChunkConcatFunc</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>concatTStreamForTest</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h3 id=runtime-type-alignment-check-scenarios><strong>Runtime Type Alignment Check Scenarios</strong></h3><p>Eino&rsquo;s Graph type alignment check will verify if the types of the two nodes match during <code>err = graph.AddEdge("node1", "node2")</code>. This allows for type mismatch errors to be identified either during the <code>graph construction process</code> or the <code>Compile process</code>, adhering to rules ①②③ as listed in <a href=/docs/eino/core_modules/chain_and_graph_orchestration/orchestration_design_principles/>Eino: The design concept of orchestration</a>.</p><p>When the upstream node&rsquo;s output is an <code>interface</code>, and the downstream node type implements that <code>interface</code>, it is likely that upstream can be converted to downstream type (type assertion). However, whether the conversion succeeds can only be determined during the <code>runtime process</code>, so type checks in this scenario are deferred to runtime.</p><p>The structure is shown in the diagram below:</p><p><a href=/img/eino/en_eino_graph_parallel_node_type.png target=_blank><img src=/img/eino/en_eino_graph_parallel_node_type.png width=100%></a></p><p>This scenario is suitable for developers who can handle upstream and downstream type alignment on their own and choose the appropriate downstream execution nodes based on different types.# User Manual for Eino</p><h2 id=opinionated-design-choices>Opinionated <strong>Design Choices</strong></h2><h3 id=principle-of-read-only-external-variables>Principle of Read-Only External Variables</h3><p>When data in Eino&rsquo;s Graph flows among Nodes, Branches, and Handlers, it is always variable assignment, not copying. When the Input is of a reference type, such as a Struct pointer, map, or slice, modifying the Input inside Nodes, Branches, or Handlers will have side effects on the outside and may lead to concurrency issues. Therefore, Eino follows the principle of read-only external variables: do not modify the Input inside Nodes, Branches, or Handlers. If modification is required, make a copy first.</p><p>This principle also applies to Chunks in the StreamReader.</p><h3 id=fan-in-and-merging><strong>Fan-In and Merging</strong></h3><p><strong>Fan-in</strong>: Outputs from multiple predecessor nodes converge to a successor node and together serve as the input for the successor node. It is necessary to clearly define how the outputs of multiple predecessor nodes are <strong>merged</strong>. Eino&rsquo;s choice is as follows. First, it requires that the <strong>actual types</strong> of the outputs of multiple predecessor nodes must be the same and of a mergeable type.</p><p>Mergeable types can be:</p><ul><li>Map type, and the keys are not repeated among each other.</li><li>Any type, and a merge function is registered through <code>compose.RegisterValuesMergeFunc</code>.</li></ul><p>Second,</p><ul><li>In non-streaming scenarios,<ul><li>if the input type has a registered merge function, it will be merged into a single value using the registered function.</li><li>if the input type is a Map, it will be merged into a single Map containing all key-value pairs from all upstream sources.</li></ul></li><li>In streaming scenarios, multiple upstream StreamReaders of the same type are merged into one StreamReader. When actually receiving data from the merged StreamReader, the effect is to read fairly from multiple upstream StreamReaders.</li></ul><p>When adding a node (AddNode), you can add the WithOutputKey option to convert the output of the node into a Map:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// The output of this node will be changed from string to map[string]any. </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#8f5902;font-style:italic>// And there is only one element in the map. The key is your_output_key, and the value is the actual string output by the node. </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000>graph</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>AddLambdaNode</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;your_node_key&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>compose</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>InvokableLambda</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>input</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>[]</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>schema</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Message</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>(</span><span style=color:#000>str</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>err</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>error</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#8f5902;font-style:italic>// your logic</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>return</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}),</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>compose</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithOutputKey</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;your_output_key&#34;</span><span style=color:#000;font-weight:700>))</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>You can also register custom merge method to support any type:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// eino/compose/values_merge.go</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>func</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RegisterValuesMergeFunc</span><span style=color:#000;font-weight:700>[</span><span style=color:#000>T</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>any</span><span style=color:#000;font-weight:700>](</span><span style=color:#000>fn</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>([]</span><span style=color:#000>T</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>(</span><span style=color:#000>T</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>error</span><span style=color:#000;font-weight:700>))</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Workflow can map the output fields of multiple predecessor nodes to different input fields of the successor node. Eino converts the Struct output from each predecessor to a Map before any merge process, still conforming to the above rules.</p><h3 id=streaming-processing><strong>Streaming Processing</strong></h3><p>Eino believes that components should only need to implement genuine streaming paradigms from the business scenario. For example, a ChatModel does not need to implement Collect. Therefore, in orchestration scenarios, Eino automatically completes the <strong>missing streaming paradigms</strong> for all nodes.</p><p>When running a Graph via Invoke, all internal nodes operate in Invoke mode. When running a Graph via Stream, Collect, or Transform, all internal nodes operate in Transform mode.</p><p><strong>Auto Concatenate</strong>: In scenarios where Stream chunks are concatenated into complete content, the user-defined concatenation function registered by the user is preferred. Otherwise, default behaviors provided by the framework are performed, including Message, Message arrays, String, Map, and Struct/Struct pointers.</p><p><strong>Auto Boxing</strong>: In scenarios requiring the conversion of non-stream type T to StreamReader[T], the framework automates the process.</p><p><strong>Auto Merge</strong>: See the above section on &ldquo;Fan-In and Merging.&rdquo;</p><p><strong>Auto Copy</strong>: In scenarios requiring the replication of streams, the framework automatically handles stream copying, including instances where a single stream fans out to multiple downstream nodes, or a single stream enters one or more callback handlers.</p><p>Finally, Eino requires all orchestration elements to be aware of and capable of handling streams. This includes branches, state handlers, callback handlers, passthroughs, lambdas, etc.</p><p>For more details on Eino&rsquo;s streaming capabilities, refer to <a href=/docs/eino/core_modules/chain_and_graph_orchestration/stream_programming_essentials/>Eino Points of Streaming Orchestration</a>.</p><h3 id=global-state><strong>Global State</strong></h3><p><strong>State</strong>: In NewGraph, pass in the creation method of State through <code>compose.WithGenLocalState</code>. This globally scoped state at the request level can be read from and written to during various stages of a single request.</p><p>Eino recommends using <code>StatePreHandler</code> and <code>StatePostHandler</code>:</p><ul><li>StatePreHandler: Before the execution of each node, read from and write to State. Replace the node&rsquo;s input as needed.</li><li>StatePostHandler: After the execution of each node, read from and write to State. Replace the node&rsquo;s output as needed.</li></ul><p>For streaming scenarios, use the corresponding <code>StreamStatePreHandler</code> and <code>StreamStatePostHandler</code>.</p><p>These state handlers are located outside the nodes and affect the nodes by modifying the Input or Output, thus ensuring the &ldquo;stateless&rdquo; property of the nodes.</p><p>If you need to read from and write to State inside the nodes, Eino provides the <code>ProcessState[S any](ctx context.Context, handler func(context.Context, S) error) error</code> function.</p><p>The Eino framework will add locks at all positions where the State is read from or written to.</p><h3 id=callback-injection><strong>Callback Injection</strong></h3><p>Eino&rsquo;s orchestration framework considers that components entering the orchestration might have internally embedded Callback aspects or might not. This information is determined by whether the component implements the <code>Checker</code> interface and the return value of the <code>IsCallbacksEnabled</code> method in the interface.</p><ul><li>When <code>IsCallbacksEnabled</code> returns true, Eino&rsquo;s orchestration framework uses the component&rsquo;s internally implemented Callback aspects.</li><li>Otherwise, it automatically wraps the component implementation with external Callback aspects, (only) reporting input and output.</li></ul><p>In either case, RunInfo will be automatically inferred.</p><p>Additionally, for the Graph as a whole, Callback aspects will always be injected, with RunInfo being the Graph itself.</p><p>For a complete explanation of Eino&rsquo;s Callback capabilities, see <a href=/docs/eino/core_modules/chain_and_graph_orchestration/callback_manual/>Eino: Callback Manual</a>.</p><h3 id=option-allocation><strong>Option Allocation</strong></h3><p>Eino supports various dimensions of Call Option allocation methods:</p><ul><li>Default global allocation, i.e., allocated to all nodes, including nested internal graphs.</li><li>An option can be added to a specific component type, in which case it is by default allocated to all nodes of that type, such as AddChatModelOption. Lambdas that have defined unique Option types can also specify the Option for themselves in this way.</li><li>Any specific nodes can be designated using <code>DesignateNode(key ...string)</code>.</li><li>Any depth of nested graphs, or any specific nodes within them, can be designated using <code>DesignateNodeWithPath(path ...*NodePath)</code>.</li></ul><p>For a complete explanation of Eino&rsquo;s Call Option capabilities, see <a href=/docs/eino/core_modules/chain_and_graph_orchestration/call_option_capabilities/>Eino: CallOption capabilities and specification</a>.</p><h3 id=graph-nesting><strong>Graph Nesting</strong></h3><p>The outcome of graph orchestration, <code>Runnable</code>, is very similar in interface form to Lambda. Therefore, a compiled graph can be simply encapsulated as a Lambda and nested into other graphs as a Lambda node.</p><p>Another way is that, before compilation, Graph, Chain, Workflow, etc., can be nested directly into other graphs using AddGraph. The differences between the two methods are:</p><ul><li>The Lambda method adds an additional Lambda node in the trace. From the perspective of other Callback handlers, there will also be an additional layer.</li><li>The Lambda method requires using the Lambda&rsquo;s Option to inherit CallOption and cannot use DesignateNodeWithPath.</li><li>The Lambda method requires the internal graph to be precompiled. Directly using AddGraph allows the internal graph to be compiled together with the parent graph.</li></ul><h2 id=internal-mechanism><strong>Internal Mechanism</strong></h2><h3 id=execution-sequence><strong>Execution Sequence</strong></h3><p>Taking an InvokableLambda (input as string, output as int) with StatePreHandler, StatePostHandler, InputKey, OutputKey added, and no Callback aspect implemented internally as an example, the complete flow execution sequence in the diagram is as follows:</p><p><a href=/img/eino/en_eino_callbacks.png target=_blank><img src=/img/eino/en_eino_callbacks.png width=100%></a></p><p>In the workflow scenario, field mapping occurs in two places:</p><ul><li>After the node execution&rsquo;s StatePostHandler and the &ldquo;stream replication&rdquo; step, each downstream-required field will be separately extracted.</li><li>After the &ldquo;merge&rdquo; step before node execution, and before StatePreHandler, the extracted upstream field values will be converted to the current node&rsquo;s input.</li></ul><h3 id=runtime-engine><strong>Runtime Engine</strong></h3><p>When <code>NodeTriggerMode == AnyPredecessor</code>, the graph executes using the pregel engine, corresponding to a directed graph with cycles. Characteristics include:</p><ul><li>One or more currently executing nodes&rsquo; all subsequent nodes collectively execute as a SuperStep. At this time, these new nodes become the &ldquo;current&rdquo; nodes.</li><li>Supports Branch, supports loops in the graph, but it may require manually adding passthrough nodes to ensure SuperStep nodes meet expectations, as illustrated below:</li></ul><p><a href=/img/eino/en_eino_run_steps.png target=_blank><img src=/img/eino/en_eino_run_steps.png width=100%></a></p><p>In the above image, Node 4 and Node 5 are executed together as per rules, which likely does not meet expectations. It needs to be changed to:</p><p><a href=/img/eino/graph_steps_in_graph.png target=_blank><img src=/img/eino/graph_steps_in_graph.png width=100%></a></p><p>When <code>NodeTriggerMode == AllPredecessor</code>, the graph executes using the dag engine, corresponding to a directed acyclic graph. Characteristics include:</p><ul><li>Each node has a specific predecessor node, and this node is only executable once all predecessor nodes are complete.</li><li>An eager mode can be selected, where there is no SuperStep concept. Each node, upon completion, immediately checks which subsequent nodes can be run and executes them at the earliest time.</li><li>Does not support cycles in the graph, as it breaks the &ldquo;each node has a specific predecessor node&rdquo; assumption.</li><li>Support Branch. At runtime, mark the unselected nodes of Branch as skipped, which does not affect the semantics of AllPredecessor.</li><li>No need for manual SuperStep alignment.</li></ul><blockquote><p>💡
When NodeTriggerMode is set to AllPredecessor, the node will execute after all predecessors are ready, but it will not execute immediately. Instead, it still follows the SuperStep - running new runnable nodes after a batch of nodes have completed execution.</p><p>If compose.WithEagerExecution() is passed in Compile, the ready nodes will run immediately.</p></blockquote><p>In summary, the pregel mode is flexible and powerful but comes with additional mental overhead, while the dag mode is clear and simple but limited in application scenarios. In the Eino framework, Chain uses the pregel mode, Workflow uses the dag mode, and Graph supports both; users can choose between pregel and dag.</p><style>.feedback--answer{display:inline-block}.feedback--answer-no{margin-left:1em}.feedback--response{display:none;margin-top:1em}.feedback--response__visible{display:block}</style><div class=d-print-none><h2 class=feedback--title>Feedback</h2><p class=feedback--question>Was this page helpful?</p><button class="btn btn-primary mb-4 feedback--answer feedback--answer-yes">Yes</button>
<button class="btn btn-primary mb-4 feedback--answer feedback--answer-no">No</button><p class="feedback--response feedback--response-yes"><a href=https://github.com/cloudwego/cloudwego.github.io/issues/new>Please tell us how we can improve</a>.</p><p class="feedback--response feedback--response-no"><a href=https://github.com/cloudwego/cloudwego.github.io/issues/new>Please tell us how we can improve</a>.</p></div><script>const yesButton=document.querySelector(".feedback--answer-yes"),noButton=document.querySelector(".feedback--answer-no"),yesResponse=document.querySelector(".feedback--response-yes"),noResponse=document.querySelector(".feedback--response-no"),disableButtons=()=>{yesButton.disabled=!0,noButton.disabled=!0},sendFeedback=e=>{if(typeof ga!="function")return;const t={command:"send",hitType:"event",category:"Helpful",action:"click",label:window.location.pathname,value:e};ga(t.command,t.hitType,t.category,t.action,t.label,t.value)};yesButton.addEventListener("click",()=>{yesResponse.classList.add("feedback--response__visible"),disableButtons(),sendFeedback(1)}),noButton.addEventListener("click",()=>{noResponse.classList.add("feedback--response__visible"),disableButtons(),sendFeedback(0)})</script><br><div class="text-muted mt-5 pt-3 border-top">Last modified
December 4, 2025
: <a href=https://github.com/cloudwego/cloudwego.github.io/commit/c69f9aa420922dcf8e87ba3efcd0ffae08940ab7>chore: deprecate docs for swagger (#1472) (c69f9aa)</a></div></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Lark aria-label=Lark><a class=text-white target=_blank rel=noopener href="https://applink.feishu.cn/client/chat/chatter/add_by_link?link_token=693v2544-2664-4421-b50f-7f1912p745r6" aria-label=Lark><img src=/webfonts/lark.svg alt style=width:26px;line-height:32.5px;margin-bottom:6px;fill:#fff></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter><a class=text-white target=_blank rel=noopener href=https://twitter.com/CloudWeGo aria-label=Twitter><img src=/webfonts/x-twitter.svg alt style=width:26px;line-height:32.5px;margin-bottom:6px;fill:#fff></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/cloudwego aria-label=GitHub><i class="fa-brands fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Discord aria-label=Discord><a class=text-white target=_blank rel=noopener href=https://discord.gg/jceZSE7DsW aria-label=Discord><i class="fa-brands fa-discord"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2025 The CloudWeGo Authors</small><p class="mt-2 text-white"><a class=cloudwego-link href=/about/ target=_blank rel=noopener>About</a>
|
<a class=cloudwego-link href=https://github.com/cloudwego/cloudwego.github.io/blob/main/LICENSE target=_blank rel=noopener>License</a></p></div></div></div></footer></div><script src=/js/popper.min.js></script><script src=/js/bootstrap.min.js></script><script src=https://cdn.jsdelivr.net/npm/mermaid@8.9.2/dist/mermaid.min.js integrity=sha384-uQikAXnCAqsMb3ygtdqBYvcwvHUkzGIpjdGyy9owhURXHUxLC5LgTcSxJQH/RzjK crossorigin=anonymous></script><script src=/js/main.min.d9cbdf3f1e3b54e04029f0e19fd6f6a99734980ad879a7561c004d01236f29e8.js integrity="sha256-2cvfPx47VOBAKfDhn9b2qZc0mArYeadWHABNASNvKeg=" crossorigin=anonymous></script><script src=/js/prism.js></script><script src=/js/prism-custom.js></script><script src=/js/tabpane-persist.js></script><script src=/js/docsearch.js></script><script type=text/javascript>let siteLang=window.location.pathname.startsWith("/zh/")?"zh":"en";docsearch({appId:"V7I042F992",apiKey:"8380a7ac88106841cb43fb000fa2edb4",indexName:"cloudwego",container:"#docsearch",searchParameters:{hitsPerPage:5,facetFilters:[`lang:${siteLang}`]},transformItems(e){return e.map(e=>({...e,url:e.url.replace("www.cloudwego.io",location.host).replace("https:",location.protocol)}))}})</script><script src=/js/outbound-link.js></script><script src=/js/navScroll.js></script></body></html>